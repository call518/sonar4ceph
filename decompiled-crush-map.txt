# begin crush map
tunable choose_local_tries 0
tunable choose_local_fallback_tries 0
tunable choose_total_tries 50
tunable chooseleaf_descend_once 1
tunable chooseleaf_vary_r 1
tunable chooseleaf_stable 1
tunable straw_calc_version 1
tunable allowed_bucket_algs 54

# devices
device 0 osd.0 class hdd
device 1 osd.1 class hdd
device 2 osd.2 class hdd
device 3 osd.3 class hdd
device 4 osd.4 class hdd
device 5 osd.5 class hdd
device 6 osd.6 class hdd
device 7 osd.7 class hdd
device 8 osd.8 class hdd
device 9 osd.9 class hdd
device 10 osd.10 class hdd
device 11 osd.11 class hdd
device 12 osd.12 class hdd
device 13 osd.13 class hdd
device 14 osd.14 class hdd
device 15 osd.15 class hdd
device 16 osd.16 class hdd
device 17 osd.17 class hdd

# types
type 0 osd
type 1 host
type 2 chassis
type 3 rack
type 4 row
type 5 pdu
type 6 pod
type 7 room
type 8 datacenter
type 9 region
type 10 root

# buckets
host ceph-1 {
	id -3		# do not change unnecessarily
	id -4 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.0 weight 0.098
	item osd.1 weight 0.098
	item osd.2 weight 0.098
}
host ceph-4 {
	id -9		# do not change unnecessarily
	id -10 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.9 weight 0.098
	item osd.10 weight 0.098
	item osd.11 weight 0.098
}
rack rack1 {
	id -17		# do not change unnecessarily
	id -18 class hdd		# do not change unnecessarily
	# weight 0.586
	alg straw2
	hash 0	# rjenkins1
	item ceph-1 weight 0.293
	item ceph-4 weight 0.293
}
host ceph-2 {
	id -5		# do not change unnecessarily
	id -6 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.3 weight 0.098
	item osd.4 weight 0.098
	item osd.5 weight 0.098
}
host ceph-5 {
	id -11		# do not change unnecessarily
	id -12 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.12 weight 0.098
	item osd.13 weight 0.098
	item osd.14 weight 0.098
}
rack rack2 {
	id -19		# do not change unnecessarily
	id -20 class hdd		# do not change unnecessarily
	# weight 0.586
	alg straw2
	hash 0	# rjenkins1
	item ceph-2 weight 0.293
	item ceph-5 weight 0.293
}
host ceph-3 {
	id -7		# do not change unnecessarily
	id -8 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.6 weight 0.098
	item osd.7 weight 0.098
	item osd.8 weight 0.098
}
host ceph-6 {
	id -13		# do not change unnecessarily
	id -14 class hdd		# do not change unnecessarily
	# weight 0.293
	alg straw2
	hash 0	# rjenkins1
	item osd.15 weight 0.098
	item osd.16 weight 0.098
	item osd.17 weight 0.098
}
rack rack3 {
	id -21		# do not change unnecessarily
	id -22 class hdd		# do not change unnecessarily
	# weight 0.586
	alg straw2
	hash 0	# rjenkins1
	item ceph-3 weight 0.293
	item ceph-6 weight 0.293
}
datacenter dc1 {
	id -15		# do not change unnecessarily
	id -16 class hdd		# do not change unnecessarily
	# weight 1.758
	alg straw2
	hash 0	# rjenkins1
	item rack1 weight 0.586
	item rack2 weight 0.586
	item rack3 weight 0.586
}
root default {
	id -1		# do not change unnecessarily
	id -2 class hdd		# do not change unnecessarily
	# weight 1.758
	alg straw2
	hash 0	# rjenkins1
	item dc1 weight 1.758
}

# rules
rule replicated_rule {
	id 0
	type replicated
	min_size 1
	max_size 10
	step take default
	step chooseleaf firstn 0 type host
	step emit
}

rule OpenStackTF-Test-Rule {
    id 1
    type replicated
    min_size 1
    max_size 3
    step take default
    step chooseleaf firstn 3 type rack
    step emit
}

# end crush map
